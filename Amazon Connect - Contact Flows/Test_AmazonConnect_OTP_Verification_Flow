{"modules":[{"id":"a7174685-610d-4f92-a818-fbef29ca3e84","type":"CheckAttribute","branches":[{"condition":"Evaluate","conditionType":"LessThanOrEqualTo","conditionValue":"3","transition":"347fb504-bc31-49c3-9eac-1bbddec5610b"},{"condition":"NoMatch","transition":"909bd368-cecb-4956-979c-16c137807325"}],"parameters":[{"name":"Attribute","value":"Attempt"},{"name":"Namespace","value":"External"}],"metadata":{"position":{"x":1302,"y":8},"conditionMetadata":[{"id":"860c1302-2207-4a94-b962-3fd4f50c220f","operator":{"name":"Is less or equal","value":"LessThanOrEqualTo","shortDisplay":"<="},"value":"3"}]}},{"id":"c6dab464-16aa-4670-b37e-a20eb19ffc48","type":"PlayPrompt","branches":[{"condition":"Success","transition":"aa3463a5-a4b2-4662-a444-02856a6046a9"}],"parameters":[{"name":"Text","value":"<speak><break time=\"1ms\"/>The OTP that customer has entered is  :<say-as interpret-as=\"digits\">$.Attributes.EnteredOTP </say-as>\n</speak>","namespace":null},{"name":"TextToSpeechType","value":"ssml"}],"metadata":{"position":{"x":2224,"y":11},"useDynamic":false}},{"id":"aa3463a5-a4b2-4662-a444-02856a6046a9","type":"CheckAttribute","branches":[{"condition":"Evaluate","conditionType":"Equals","conditionValue":"$.Attributes.OTP","transition":"14de3bdd-7202-4a89-96f5-d1ae12690b62"},{"condition":"NoMatch","transition":"1c1a6c2f-4ab6-4d70-9e21-e25a1e5e6e7f"}],"parameters":[{"name":"Attribute","value":"Stored customer input"},{"name":"Namespace","value":"System"}],"metadata":{"position":{"x":2455,"y":13},"conditionMetadata":[{"id":"8f3f3bfe-08fa-4064-89a9-caeea37dddef","operator":{"name":"Equals","value":"Equals","shortDisplay":"="},"value":"$.Attributes.OTP"}]}},{"id":"1c1a6c2f-4ab6-4d70-9e21-e25a1e5e6e7f","type":"PlayPrompt","branches":[{"condition":"Success","transition":"b7353e8a-9efe-4b90-80b1-7ed49135026d"}],"parameters":[{"name":"Text","value":"<speak><break time=\"1s\"/> Error, <break time=\"1ms\"/> O T P mismatch </speak>","namespace":null},{"name":"TextToSpeechType","value":"ssml"}],"metadata":{"position":{"x":2734,"y":219},"useDynamic":false}},{"id":"b7353e8a-9efe-4b90-80b1-7ed49135026d","type":"SetAttributes","branches":[{"condition":"Success","transition":"5ecf77d8-9813-4358-8748-cace8f3f21c4"},{"condition":"Error","transition":"9b843edc-4ecc-4f89-bdb4-f0dae10c3213"}],"parameters":[{"name":"Attribute","value":"$.External.Attempt","key":"AttemptNumber","namespace":null}],"metadata":{"position":{"x":2981,"y":280}}},{"id":"a8ffd11f-d80d-49ab-83be-03712e361695","type":"SetAttributes","branches":[{"condition":"Success","transition":"5ecf77d8-9813-4358-8748-cace8f3f21c4"},{"condition":"Error","transition":"9b843edc-4ecc-4f89-bdb4-f0dae10c3213"}],"parameters":[{"name":"Attribute","value":"0","key":"AttemptNumber","namespace":null},{"name":"Attribute","value":"$.External.OTP","key":"OTP","namespace":null}],"metadata":{"position":{"x":603,"y":7}}},{"id":"5ecf77d8-9813-4358-8748-cace8f3f21c4","type":"InvokeExternalResource","branches":[{"condition":"Success","transition":"c386cddb-951a-4ae2-bc7e-586134ebeb59"},{"condition":"Error","transition":"9b843edc-4ecc-4f89-bdb4-f0dae10c3213"}],"parameters":[{"name":"FunctionArn","value":"arn:aws:lambda:us-east-1:978477803387:function:AmazonConnect_AttemptNumber"},{"name":"TimeLimit","value":"5"},{"name":"Parameter","key":"AttemptNumber","value":"$.Attributes.AttemptNumber","namespace":null}],"metadata":{"position":{"x":834,"y":10},"dynamicMetadata":{"AttemptNumber":false}},"target":"Lambda"},{"id":"909bd368-cecb-4956-979c-16c137807325","type":"PlayPrompt","branches":[{"condition":"Success","transition":"9b843edc-4ecc-4f89-bdb4-f0dae10c3213"}],"parameters":[{"name":"Text","value":"speak><break time=\"1s\"/> Sorry you have exceeded the number of attempts, disconnecting your call. </speak>","namespace":null},{"name":"TextToSpeechType","value":"ssml"}],"metadata":{"position":{"x":1502,"y":369},"useDynamic":false}},{"id":"c386cddb-951a-4ae2-bc7e-586134ebeb59","type":"SetAttributes","branches":[{"condition":"Success","transition":"a7174685-610d-4f92-a818-fbef29ca3e84"},{"condition":"Error","transition":"9b843edc-4ecc-4f89-bdb4-f0dae10c3213"}],"parameters":[{"name":"Attribute","value":"$.External.Attempt","key":"Attempt","namespace":"External"}],"metadata":{"position":{"x":1071,"y":6}}},{"id":"a4de6797-a483-491d-b5fd-b24e7769fab2","type":"SetAttributes","branches":[{"condition":"Success","transition":"c6dab464-16aa-4670-b37e-a20eb19ffc48"},{"condition":"Error","transition":"9b843edc-4ecc-4f89-bdb4-f0dae10c3213"}],"parameters":[{"name":"Attribute","value":"Stored customer input","key":"EnteredOTP","namespace":"System"}],"metadata":{"position":{"x":2003,"y":4}}},{"id":"347fb504-bc31-49c3-9eac-1bbddec5610b","type":"PlayPrompt","branches":[{"condition":"Success","transition":"d670b4b7-272a-4916-9a82-8fd444718519"}],"parameters":[{"name":"Text","value":"<speak><break time=\"11ms\"/>Attempt Number :<say-as interpret-as=\"digits\">$.Attributes.Attempt</say-as> \n</speak>","namespace":null},{"name":"TextToSpeechType","value":"ssml"}],"metadata":{"position":{"x":1532,"y":10},"useDynamic":false}},{"id":"d670b4b7-272a-4916-9a82-8fd444718519","type":"StoreUserInput","branches":[{"condition":"Success","transition":"a4de6797-a483-491d-b5fd-b24e7769fab2"},{"condition":"Error","transition":"9b843edc-4ecc-4f89-bdb4-f0dae10c3213"}],"parameters":[{"name":"Text","value":"<speak>Please enter your O T P </speak>","namespace":null},{"name":"TextToSpeechType","value":"ssml"},{"name":"CustomerInputType","value":"Custom"},{"name":"Timeout","value":"5"},{"name":"MaxDigits","value":4},{"name":"EncryptEntry","value":false}],"metadata":{"position":{"x":1760,"y":4},"useDynamic":false,"useDynamicForEncryptionKeys":true,"countryCodePrefix":"+1"}},{"id":"14de3bdd-7202-4a89-96f5-d1ae12690b62","type":"PlayPrompt","branches":[{"condition":"Success","transition":"3f73a61c-8229-46aa-a54c-7204a9ca05fc"}],"parameters":[{"name":"Text","value":"<speak><break time=\"1ms\"/> O T P verified successfully </speak>","namespace":null},{"name":"TextToSpeechType","value":"ssml"}],"metadata":{"position":{"x":2731,"y":16},"useDynamic":false}},{"id":"3f73a61c-8229-46aa-a54c-7204a9ca05fc","type":"Transfer","branches":[{"condition":"Error","transition":"9b843edc-4ecc-4f89-bdb4-f0dae10c3213"}],"parameters":[{"name":"ContactFlowId","value":"arn:aws:connect:us-east-1:978477803387:instance/f8c3d4f8-7e27-4834-a0d2-727815ad37e1/contact-flow/7f9e37c4-14cd-4575-bfe0-724980ba7eb2","resourceName":"Test_AmazonConnect_New_TPIN_Flow"}],"metadata":{"position":{"x":2981,"y":24},"useDynamic":false,"ContactFlow":{"id":"arn:aws:connect:us-east-1:978477803387:instance/f8c3d4f8-7e27-4834-a0d2-727815ad37e1/contact-flow/7f9e37c4-14cd-4575-bfe0-724980ba7eb2","text":"Test_AmazonConnect_New_TPIN_Flow"}},"target":"Flow"},{"id":"a7695a91-d385-4546-9277-ba3672289627","type":"PlayPrompt","branches":[{"condition":"Success","transition":"a8ffd11f-d80d-49ab-83be-03712e361695"}],"parameters":[{"name":"Text","value":"<speak><break time=\"3ms\"/>The O T P that lambda function has returned is  :<say-as interpret-as=\"digits\">$.External.OTP </say-as> \n</speak>","namespace":null},{"name":"TextToSpeechType","value":"ssml"}],"metadata":{"position":{"x":385,"y":19},"useDynamic":false}},{"id":"312e2359-5c59-4ae0-9c79-af0686e12b3e","type":"InvokeExternalResource","branches":[{"condition":"Success","transition":"a7695a91-d385-4546-9277-ba3672289627"},{"condition":"Error","transition":"2cd43a5d-1a32-4b4a-a5a0-aea47cc6b160"}],"parameters":[{"name":"FunctionArn","value":"arn:aws:lambda:us-east-1:978477803387:function:AmazonConnect_GenerateOTP"},{"name":"TimeLimit","value":"4"}],"metadata":{"position":{"x":170,"y":23},"dynamicMetadata":{}},"target":"Lambda"},{"id":"2cd43a5d-1a32-4b4a-a5a0-aea47cc6b160","type":"PlayPrompt","branches":[{"condition":"Success","transition":"9b843edc-4ecc-4f89-bdb4-f0dae10c3213"}],"parameters":[{"name":"Text","value":"<speak><break time=\"1s\"/> Error in O T P Generation, disconnecting the call </speak>","namespace":null},{"name":"TextToSpeechType","value":"ssml"}],"metadata":{"position":{"x":584,"y":259},"useDynamic":false}},{"id":"9b843edc-4ecc-4f89-bdb4-f0dae10c3213","type":"Disconnect","branches":[],"parameters":[],"metadata":{"position":{"x":3249,"y":558}}},{"id":"c195f287-ca98-4fc0-a5e6-c3573adbde7b","type":"StoreUserInput","branches":[{"condition":"Success","transition":"072e17e5-6a6c-4f4b-8ef6-d8479eee0d48"},{"condition":"Error","transition":"8ee4dc35-775e-492e-8985-b02a6eb95dbf"}],"parameters":[{"name":"Text","value":"Please press 1 if you want us to send you a code at this number.","namespace":null},{"name":"TextToSpeechType","value":"text"},{"name":"CustomerInputType","value":"Custom"},{"name":"Timeout","value":"5"},{"name":"MaxDigits","value":4},{"name":"EncryptEntry","value":false}],"metadata":{"position":{"x":48,"y":255},"useDynamic":false,"useDynamicForEncryptionKeys":true,"countryCodePrefix":"+1"}},{"id":"072e17e5-6a6c-4f4b-8ef6-d8479eee0d48","type":"CheckAttribute","branches":[{"condition":"Evaluate","conditionType":"Equals","conditionValue":"1","transition":"312e2359-5c59-4ae0-9c79-af0686e12b3e"},{"condition":"NoMatch","transition":"8ee4dc35-775e-492e-8985-b02a6eb95dbf"}],"parameters":[{"name":"Attribute","value":"Stored customer input"},{"name":"Namespace","value":"System"}],"metadata":{"position":{"x":312,"y":267},"conditionMetadata":[{"id":"1122d6e6-8a8e-46f4-b8df-55ad237effc6","operator":{"name":"Equals","value":"Equals","shortDisplay":"="},"value":"1"}]}},{"id":"8ee4dc35-775e-492e-8985-b02a6eb95dbf","type":"PlayPrompt","branches":[{"condition":"Success","transition":"9b843edc-4ecc-4f89-bdb4-f0dae10c3213"}],"parameters":[{"name":"Text","value":"<speak><prosody rate=\"medium\" pitch=\"-2st\"> Sorry we did not receive your proper input, disconnecting the call </prosody></speak>","namespace":null},{"name":"TextToSpeechType","value":"ssml"}],"metadata":{"position":{"x":306,"y":568},"useDynamic":false}}],"version":"1","type":"contactFlow","start":"c195f287-ca98-4fc0-a5e6-c3573adbde7b","metadata":{"entryPointPosition":{"x":27,"y":44},"snapToGrid":false,"name":"Test_AmazonConnect_OTP_Verification_Flow","description":null,"type":"contactFlow","status":"published","hash":"e32b849973ebdb5468f68a7eb74dadde690508152a1179cb138ce89c38597fb3"}}